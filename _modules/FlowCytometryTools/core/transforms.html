<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>FlowCytometryTools.core.transforms &#8212; FlowCytometryTools 0.5.0 documentation</title>
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>
  
  <a href="https://github.com/eyurtsev/flowcytometrytools"
     class="visible-desktop hidden-xs"><img
    id="gh-banner"
    style="position: absolute; top: 50px; right: 0; border: 0;"
    src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png"
    alt="Fork me on GitHub"></a>
  <script>
    // Adjust banner height.
    $(function () {
      var navHeight = $(".navbar .container").css("height");
      $("#gh-banner").css("top", navHeight);
    });
  </script>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html">
          FlowCytometryTools</a>
        <span class="navbar-text navbar-version pull-left"><b>0.5.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../../gallery.html">Gallery</a></li>
                <li><a href="../../../install.html">Install</a></li>
                <li><a href="../../../tutorial.html">Tutorial</a></li>
                <li><a href="../../../api.html">API</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary">
<form action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-9 content">
      
  <h1>Source code for FlowCytometryTools.core.transforms</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;&#39;</span>
<span class="sd">Various transformations for flow cytometry data.</span>
<span class="sd">The forward transformations all refer to transforming the</span>
<span class="sd">raw data off the machine (i.e. a log transformation is the forword</span>
<span class="sd">and an exponential is its inverse).</span>

<span class="sd">References:</span>
<span class="sd">Bagwell. Cytometry Part A, 2005.</span>
<span class="sd">Parks, Roederer, and Moore. Cytometry Part A, 2006.</span>
<span class="sd">Trotter, Joseph. In Current Protocols in Cytometry. John Wiley &amp; Sons, Inc., 2001.</span>

<span class="sd">TODO:</span>
<span class="sd">- Add scale parameters (r,d) to glog (if needed?)</span>
<span class="sd">- Implement logicle transformation.</span>
<span class="sd">- Add support for transforming a numpy array</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span>

<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="p">(</span><span class="n">log</span><span class="p">,</span> <span class="n">log10</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">where</span><span class="p">,</span> <span class="n">sign</span><span class="p">,</span> <span class="n">vectorize</span><span class="p">,</span> <span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">linspace</span><span class="p">,</span> <span class="n">logspace</span><span class="p">,</span> <span class="n">r_</span><span class="p">,</span> <span class="nb">abs</span><span class="p">,</span>
                   <span class="n">asarray</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">numpy.lib.shape_base</span> <span class="k">import</span> <span class="n">apply_along_axis</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="k">import</span> <span class="n">InterpolatedUnivariateSpline</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="k">import</span> <span class="n">brentq</span>

<span class="kn">from</span> <span class="nn">FlowCytometryTools.core.utils</span> <span class="k">import</span> <span class="n">to_list</span><span class="p">,</span> <span class="n">BaseObject</span>

<span class="n">_machine_max</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">18</span>
<span class="n">_l_mmax</span> <span class="o">=</span> <span class="n">log10</span><span class="p">(</span><span class="n">_machine_max</span><span class="p">)</span>
<span class="n">_display_max</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="mi">4</span>


<div class="viewcode-block" id="linear"><a class="viewcode-back" href="../../../API/FlowCytometryTools.core.transforms.linear.html#FlowCytometryTools.core.transforms.linear">[docs]</a><span class="k">def</span> <span class="nf">linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">old_range</span><span class="p">,</span> <span class="n">new_range</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Rescale each channel to the new range as following:</span>
<span class="sd">    new = data/old_range*new_range</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : DataFrame</span>
<span class="sd">        data to be rescaled</span>
<span class="sd">    new_range : float | array | Series</span>
<span class="sd">        Maximal data value after rescaling</span>
<span class="sd">    old_range : float | array | Series</span>
<span class="sd">        Maximal data value before rescaling</span>
<span class="sd">        (If old range is not given use the one specified in self.meta[&#39;_channels_&#39;][&#39;$PnR&#39;])</span>
<span class="sd">        Deprecated!!!</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">old_range</span> <span class="o">*</span> <span class="n">new_range</span></div>
    <span class="k">return</span> <span class="n">y</span>


<span class="n">rescale</span> <span class="o">=</span> <span class="n">linear</span>


<div class="viewcode-block" id="tlog"><a class="viewcode-back" href="../../../API/FlowCytometryTools.core.transforms.tlog.html#FlowCytometryTools.core.transforms.tlog">[docs]</a><span class="k">def</span> <span class="nf">tlog</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">th</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">_display_max</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">_l_mmax</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Truncated log10 transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : num | num iterable</span>
<span class="sd">        values to be transformed.</span>
<span class="sd">    th : num</span>
<span class="sd">        values below th are transormed to 0.</span>
<span class="sd">        Must be positive.</span>
<span class="sd">    r : num (default = 10**4)</span>
<span class="sd">        maximal transformed value.</span>
<span class="sd">    d : num (default = log10(2**18))</span>
<span class="sd">        log10 of maximal possible measured value.</span>
<span class="sd">        tlog(10**d) = r</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Array of transformed values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">th</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Threshold value must be positive. </span><span class="si">%s</span><span class="s1"> given.&#39;</span> <span class="o">%</span> <span class="n">th</span><span class="p">)</span></div>
    <span class="k">return</span> <span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">th</span><span class="p">,</span> <span class="n">log10</span><span class="p">(</span><span class="n">th</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.</span> <span class="o">*</span> <span class="n">r</span> <span class="o">/</span> <span class="n">d</span><span class="p">,</span> <span class="n">log10</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.</span> <span class="o">*</span> <span class="n">r</span> <span class="o">/</span> <span class="n">d</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">tlog_inv</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">th</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">_display_max</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">_l_mmax</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Inverse truncated log10 transform.</span>
<span class="sd">    Values</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    y : num | num iterable</span>
<span class="sd">        values to be transformed.</span>
<span class="sd">    th : num</span>
<span class="sd">        Inverse values below th are transormed to th.</span>
<span class="sd">        Must be &gt; positive.</span>
<span class="sd">    r : num (default = 10**4)</span>
<span class="sd">        maximal transformed value.</span>
<span class="sd">    d : num (default = log10(2**18))</span>
<span class="sd">        log10 of maximal possible measured value.</span>
<span class="sd">        tlog_inv(r) = 10**d</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Array of transformed values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">th</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Threshold value must be positive. </span><span class="si">%s</span><span class="s1"> given.&#39;</span> <span class="o">%</span> <span class="n">th</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">y</span> <span class="o">*</span> <span class="mf">1.</span> <span class="o">*</span> <span class="n">d</span> <span class="o">/</span> <span class="n">r</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">x</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">th</span><span class="p">]</span> <span class="o">=</span> <span class="n">th</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">th</span><span class="p">:</span> <span class="n">x</span> <span class="o">=</span> <span class="n">th</span>
    <span class="k">return</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">glog</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Natural base generalized-log transform.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">l</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">glog_inv</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span>
    <span class="n">ey</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">ey</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">l</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ey</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">hlog_inv</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">_display_max</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">_l_mmax</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Inverse of base 10 hyperlog transform.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">aux</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">*</span> <span class="n">d</span> <span class="o">/</span> <span class="n">r</span> <span class="o">*</span> <span class="n">y</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">sign</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>  <span class="c1"># to catch case where input is a single number</span>
        <span class="n">s</span><span class="p">[</span><span class="n">s</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">s</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">s</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">s</span> <span class="o">*</span> <span class="n">aux</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">aux</span> <span class="o">-</span> <span class="n">s</span>


<span class="k">def</span> <span class="nf">_x_for_spln</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">log_spacing</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create vector of values to be used in constructing a spline.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : num | num iterable</span>
<span class="sd">        Resulted values will span the range [min(x), max(x)]</span>
<span class="sd">    nx : int</span>
<span class="sd">        Length of returned vector.</span>
<span class="sd">    log_spacing: bool</span>
<span class="sd">        False - Create linearly spaced values.</span>
<span class="sd">        True - Create logarithmically spaced values.</span>
<span class="sd">            To extend to negative values, the spacing is done separately on the</span>
<span class="sd">            negative and positive range, and these are later combined.</span>
<span class="sd">            The number of points in the negative/positive range is proportional</span>
<span class="sd">            to their relative range in log space. i.e., for data in the range</span>
<span class="sd">            [-100, 1000] 2/5 of the resulting points will be in the negative range.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    x_spln : array</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">xmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">xmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">xmin</span> <span class="o">==</span> <span class="n">xmax</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">asarray</span><span class="p">([</span><span class="n">xmin</span><span class="p">]</span> <span class="o">*</span> <span class="n">nx</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">xmax</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># all values&lt;=0</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">_x_for_spln</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">log_spacing</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">log_spacing</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>

    <span class="c1"># All code below is to handle-log-spacing when x has potentially both negative</span>
    <span class="c1"># and positive values.</span>
    <span class="k">if</span> <span class="n">xmin</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">logspace</span><span class="p">(</span><span class="n">log10</span><span class="p">(</span><span class="n">xmin</span><span class="p">),</span> <span class="n">log10</span><span class="p">(</span><span class="n">xmax</span><span class="p">),</span> <span class="n">nx</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lxmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">log10</span><span class="p">(</span><span class="n">xmax</span><span class="p">),</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">lxmin</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">xmin</span><span class="p">)),</span> <span class="mi">0</span><span class="p">])</span>

        <span class="c1"># All the code below is for log-spacing, when xmin &lt; 0 and xmax &gt; 0</span>
        <span class="k">if</span> <span class="n">lxmax</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">lxmin</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>  <span class="c1"># Use linear spacing as fallback</span>

        <span class="k">if</span> <span class="n">xmin</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">x_spln</span> <span class="o">=</span> <span class="n">logspace</span><span class="p">(</span><span class="n">lxmin</span><span class="p">,</span> <span class="n">lxmax</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">xmin</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">x_spln</span> <span class="o">=</span> <span class="n">r_</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lxmax</span><span class="p">,</span> <span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># (xmin &lt; 0)</span>
            <span class="n">f</span> <span class="o">=</span> <span class="n">lxmin</span> <span class="o">/</span> <span class="p">(</span><span class="n">lxmin</span> <span class="o">+</span> <span class="n">lxmax</span><span class="p">)</span>
            <span class="n">nx_neg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">f</span> <span class="o">*</span> <span class="n">nx</span><span class="p">)</span>
            <span class="n">nx_pos</span> <span class="o">=</span> <span class="n">nx</span> <span class="o">-</span> <span class="n">nx_neg</span>

            <span class="k">if</span> <span class="n">nx</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># If triggered fix edge case behavior</span>
                <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;nx should never bebe 0 or 1&#39;</span><span class="p">)</span>

            <span class="c1"># Work-around various edge cases</span>
            <span class="k">if</span> <span class="n">nx_neg</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">nx_neg</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">nx_pos</span> <span class="o">=</span> <span class="n">nx_pos</span> <span class="o">-</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="n">nx_pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">nx_pos</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">nx_neg</span> <span class="o">=</span> <span class="n">nx_neg</span> <span class="o">-</span> <span class="mi">1</span>

            <span class="n">x_spln_pos</span> <span class="o">=</span> <span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">lxmax</span><span class="p">,</span> <span class="n">nx_pos</span><span class="p">)</span>
            <span class="n">x_spln_neg</span> <span class="o">=</span> <span class="o">-</span><span class="n">logspace</span><span class="p">(</span><span class="n">lxmin</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nx_neg</span><span class="p">)</span>

            <span class="n">x_spln</span> <span class="o">=</span> <span class="n">r_</span><span class="p">[</span><span class="n">x_spln_neg</span><span class="p">,</span> <span class="n">x_spln_pos</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">x_spln</span>


<span class="k">def</span> <span class="nf">_make_hlog_numeric</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a function that numerically computes the hlog transformation for given parameter values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hlog_obj</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">hlog_inv</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span>
    <span class="n">find_inv</span> <span class="o">=</span> <span class="n">vectorize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">brentq</span><span class="p">(</span><span class="n">hlog_obj</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">r</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">r</span><span class="p">,</span>
                                          <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">find_inv</span>


<div class="viewcode-block" id="hlog"><a class="viewcode-back" href="../../../API/FlowCytometryTools.core.transforms.hlog.html#FlowCytometryTools.core.transforms.hlog">[docs]</a><span class="k">def</span> <span class="nf">hlog</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">_display_max</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">_l_mmax</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base 10 hyperlog transform.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : num | num iterable</span>
<span class="sd">        values to be transformed.</span>
<span class="sd">    b : num</span>
<span class="sd">        Parameter controling the location of the shift</span>
<span class="sd">        from linear to log transformation.</span>
<span class="sd">    r : num (default = 10**4)</span>
<span class="sd">        maximal transformed value.</span>
<span class="sd">    d : num (default = log10(2**18))</span>
<span class="sd">        log10 of maximal possible measured value.</span>
<span class="sd">        hlog_inv(r) = 10**d</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Array of transformed values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hlog_fun</span> <span class="o">=</span> <span class="n">_make_hlog_numeric</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;__len__&#39;</span><span class="p">):</span>  <span class="c1"># if transforming a single number</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">hlog_fun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">n</span><span class="p">:</span>  <span class="c1"># if transforming empty container</span>
            <span class="k">return</span> <span class="n">x</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">hlog_fun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></div>
    <span class="k">return</span> <span class="n">y</span>


<span class="n">_canonical_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;linear&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lin&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
    <span class="s1">&#39;rescale&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
    <span class="s1">&#39;hlog&#39;</span><span class="p">:</span> <span class="s1">&#39;hlog&#39;</span><span class="p">,</span>
    <span class="s1">&#39;hyperlog&#39;</span><span class="p">:</span> <span class="s1">&#39;hlog&#39;</span><span class="p">,</span>
    <span class="s1">&#39;glog&#39;</span><span class="p">:</span> <span class="s1">&#39;glog&#39;</span><span class="p">,</span>
    <span class="s1">&#39;tlog&#39;</span><span class="p">:</span> <span class="s1">&#39;tlog&#39;</span><span class="p">,</span>
<span class="p">}</span>


<span class="k">def</span> <span class="nf">_get_canonical_name</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">_canonical_names</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>


<span class="n">name_transforms</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;linear&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;forward&#39;</span><span class="p">:</span> <span class="n">linear</span><span class="p">,</span> <span class="s1">&#39;inverse&#39;</span><span class="p">:</span> <span class="n">linear</span><span class="p">},</span>
    <span class="s1">&#39;hlog&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;forward&#39;</span><span class="p">:</span> <span class="n">hlog</span><span class="p">,</span> <span class="s1">&#39;inverse&#39;</span><span class="p">:</span> <span class="n">hlog_inv</span><span class="p">},</span>
    <span class="s1">&#39;glog&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;forward&#39;</span><span class="p">:</span> <span class="n">glog</span><span class="p">,</span> <span class="s1">&#39;inverse&#39;</span><span class="p">:</span> <span class="n">glog_inv</span><span class="p">},</span>
    <span class="s1">&#39;tlog&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;forward&#39;</span><span class="p">:</span> <span class="n">tlog</span><span class="p">,</span> <span class="s1">&#39;inverse&#39;</span><span class="p">:</span> <span class="n">tlog_inv</span><span class="p">},</span>
<span class="p">}</span>


<span class="k">def</span> <span class="nf">parse_transform</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;forward&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    direction : &#39;forward&#39; | &#39;inverse&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">):</span>
        <span class="n">tfun</span> <span class="o">=</span> <span class="n">transform</span>
        <span class="n">tname</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="s1">&#39;lower&#39;</span><span class="p">):</span>
        <span class="n">tname</span> <span class="o">=</span> <span class="n">_get_canonical_name</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown transform: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">transform</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tfun</span> <span class="o">=</span> <span class="n">name_transforms</span><span class="p">[</span><span class="n">tname</span><span class="p">][</span><span class="n">direction</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Unsupported transform type: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">transform</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">tfun</span><span class="p">,</span> <span class="n">tname</span>


<span class="k">def</span> <span class="nf">transform_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">transform</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;forward&#39;</span><span class="p">,</span>
                    <span class="n">return_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply transform to specified columns.</span>

<span class="sd">    direction: &#39;forward&#39; | &#39;inverse&#39;</span>
<span class="sd">    return_all: bool</span>
<span class="sd">        True -  return all columns, with specified ones transformed.</span>
<span class="sd">        False - return only specified columns.</span>

<span class="sd">    .. warning:: deprecated</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tfun</span><span class="p">,</span> <span class="n">tname</span> <span class="o">=</span> <span class="n">parse_transform</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="n">direction</span><span class="p">)</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="n">to_list</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">columns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">columns</span>
    <span class="k">if</span> <span class="n">return_all</span><span class="p">:</span>
        <span class="n">transformed</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">transformed</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">tfun</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">transformed</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">tfun</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">transformed</span>


<span class="k">class</span> <span class="nc">Transformation</span><span class="p">(</span><span class="n">BaseObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A transformation for flow cytometry data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transform</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;forward&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spln</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        transform: callable | str</span>
<span class="sd">            Callable that does a transformation (should accept a number or array),</span>
<span class="sd">            or one of the supported named transformations.</span>
<span class="sd">            Supported transformation are: {}.</span>
<span class="sd">        direction: &#39;forward&#39; | &#39;inverse&#39;</span>
<span class="sd">            Direction of the transformation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tfun</span><span class="p">,</span> <span class="n">tname</span> <span class="o">=</span> <span class="n">parse_transform</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="n">direction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tfun</span> <span class="o">=</span> <span class="n">tfun</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tname</span> <span class="o">=</span> <span class="n">tname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spln</span> <span class="o">=</span> <span class="n">spln</span>

    <span class="fm">__init__</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="fm">__init__</span><span class="o">.</span><span class="vm">__doc__</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name_transforms</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">use_spln</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply transform to x</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : float-array-convertible</span>
<span class="sd">            Data to be transformed.</span>
<span class="sd">            Should support conversion to an array of floats.</span>
<span class="sd">        use_spln: bool</span>
<span class="sd">            True - transform using the spline specified in self.slpn.</span>
<span class="sd">                    If self.spln is None, set the spline.</span>
<span class="sd">            False - transform using self.tfun</span>
<span class="sd">        kwargs:</span>
<span class="sd">            Keyword arguments to be passed to self.set_spline.</span>
<span class="sd">            Only used if use_spln=True &amp; self.spln=None.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Array of transformed values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">use_spln</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spln</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_spline</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">apply_along_axis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spln</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tfun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="fm">__call__</span> <span class="o">=</span> <span class="n">transform</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">inverse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;inverse is supported only for named transforms. Returning None.&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;forward&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;inverse&#39;</span> <span class="k">else</span> <span class="s1">&#39;inverse&#39;</span>
            <span class="n">ifun</span> <span class="o">=</span> <span class="n">name_transforms</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">tname</span><span class="p">][</span><span class="n">direction</span><span class="p">]</span>
            <span class="n">tinv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">tinv</span><span class="o">.</span><span class="n">tfun</span> <span class="o">=</span> <span class="n">ifun</span>
            <span class="n">tinv</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span>
        <span class="k">return</span> <span class="n">tinv</span>

    <span class="k">def</span> <span class="nf">set_spline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">log_spacing</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">log_spacing</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tname</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;hlog&#39;</span><span class="p">,</span> <span class="s1">&#39;tlog&#39;</span><span class="p">,</span> <span class="s1">&#39;glog&#39;</span><span class="p">]:</span>
                <span class="n">log_spacing</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">log_spacing</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">x_spln</span> <span class="o">=</span> <span class="n">_x_for_spln</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">],</span> <span class="n">nx</span><span class="p">,</span> <span class="n">log_spacing</span><span class="p">)</span>
        <span class="n">y_spln</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="n">x_spln</span><span class="p">)</span>
        <span class="n">spln</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span><span class="n">x_spln</span><span class="p">,</span> <span class="n">y_spln</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spln</span> <span class="o">=</span> <span class="n">spln</span>
</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, Eugene Yurtsev and Jonathan Friedman.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>